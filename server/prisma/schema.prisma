// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

// --------------------------------------
// 1. The Branch
// --------------------------------------
model Branch {
  id          Int      @id @default(autoincrement())
  name        String
  isHub       Boolean  @default(false)
  transitDays Int
  orders      Order[]
  salesPerson SalesPerson[]
}

// --------------------------------------
// 2. The Customer
// --------------------------------------
model Customer {
  id          Int      @id @default(autoincrement())
  firstName   String
  lastName    String?
  phone       String   @unique
  email       String?
  orders      Order[]
}

// --------------------------------------
// 3. The Services Menu
// --------------------------------------
model Service {
  id          Int      @id @default(autoincrement())
  name        String
  price       Decimal  
  category    String   @default("COLOR") // Changed from Enum to String
  orders      Order[]
}

// --------------------------------------
// 4. The Order
// --------------------------------------
model Order {
  id              Int         @id @default(autoincrement())
  createdAt       DateTime    @default(now())
  
  // Changed from Enum to String for SQLite compatibility
  status          String      @default("RECEIVED") 
  expectedDate    DateTime
  
  customer        Customer    @relation(fields: [customerId], references: [id])
  customerId      Int
  
  branch          Branch      @relation(fields: [branchId], references: [id])
  branchId        Int

  service         Service     @relation(fields: [serviceId], references: [id])
  serviceId       Int
  priceAtOrder    Decimal     

  salesPerson     SalesPerson? @relation(fields: [salesPersonId], references: [id])
  salesPersonId   Int?

  smashLink       String?
  previewImages   String?     
}

model SalesPerson{
  id              Int         @id @default(autoincrement())
  name            String
  
  branch          Branch      @relation(fields: [branchId], references: [id])
  branchId        Int 

  isActive        Boolean  @default(true) // To hide staff who left the company
  orders          Order[]
}